function [y, T, residual, g1] = dynamic_2(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(9, 1);
  residual(1)=(y(30))-(params(23)*y(3)+(1-params(23))*(params(19)*y(31)+y(28)*params(21))+x(1));
  residual(2)=(y(34))-(params(24)*y(7)+(1-params(24))*(params(20)*y(35)+y(32)*params(22))+y(30)*params(25)+params(26)*y(51)+x(2));
  T(2)=(1+params(11))/((1+params(10))*params(1));
  residual(3)=(y(32))-(y(59)-T(2)*y(34)+T(2)*y(60)+y(55)*params(10)/(1+params(10))-y(28)*params(10)/(1+params(10))+T(2)*y(37));
  residual(4)=(y(51))-(params(27)*y(24)+y(35)*params(28)+x(5));
  residual(5)=(y(28))-(y(55)-T(2)*y(30)+T(2)*y(56)+params(10)/(1+params(10))*y(59)-params(10)/(1+params(10))*y(32)+T(2)*y(36));
  T(3)=params(1)*params(6)/(1+params(11));
  residual(6)=(y(31))-(y(29)+T(3)*(y(28)-y(1))-T(3)*(y(32)-y(5))+params(16)*(y(38)-y(11))-params(16)*(y(39)-y(12)));
  residual(7)=(y(35))-(params(16)*(y(39)-y(12))+y(33)+T(3)*(y(32)-y(5))-T(3)*(y(28)-y(1))-params(16)*(y(38)-y(11)));
  residual(8)=(y(33))-(params(3)*y(60)+y(32)*params(13)*params(9)/(1+params(11))+y(28)*params(1)*params(10)*params(9)/(1+params(11))+y(34)*params(9));
  residual(9)=(y(29))-(y(56)*params(3)+y(28)*params(8)*params(13)/(1+params(11))+y(32)*params(1)*params(10)*params(8)/(1+params(11))+y(30)*params(8));
if nargout > 3
    g1_v = NaN(47, 1);
g1_v(1)=(-params(24));
g1_v(2)=(-params(27));
g1_v(3)=(-params(23));
g1_v(4)=T(3);
g1_v(5)=(-T(3));
g1_v(6)=(-T(3));
g1_v(7)=T(3);
g1_v(8)=(-((1-params(23))*params(19)));
g1_v(9)=1;
g1_v(10)=(-((1-params(24))*params(20)));
g1_v(11)=(-params(28));
g1_v(12)=1;
g1_v(13)=1;
g1_v(14)=T(2);
g1_v(15)=(-params(9));
g1_v(16)=(-params(26));
g1_v(17)=1;
g1_v(18)=1;
g1_v(19)=(-params(25));
g1_v(20)=T(2);
g1_v(21)=(-params(8));
g1_v(22)=(-((1-params(23))*params(21)));
g1_v(23)=params(10)/(1+params(10));
g1_v(24)=1;
g1_v(25)=(-T(3));
g1_v(26)=T(3);
g1_v(27)=(-(params(1)*params(10)*params(9)/(1+params(11))));
g1_v(28)=(-(params(8)*params(13)/(1+params(11))));
g1_v(29)=(-((1-params(24))*params(22)));
g1_v(30)=1;
g1_v(31)=params(10)/(1+params(10));
g1_v(32)=T(3);
g1_v(33)=(-T(3));
g1_v(34)=(-(params(13)*params(9)/(1+params(11))));
g1_v(35)=(-(params(1)*params(10)*params(8)/(1+params(11))));
g1_v(36)=(-1);
g1_v(37)=1;
g1_v(38)=(-1);
g1_v(39)=1;
g1_v(40)=(-(params(10)/(1+params(10))));
g1_v(41)=(-1);
g1_v(42)=(-1);
g1_v(43)=(-(params(10)/(1+params(10))));
g1_v(44)=(-T(2));
g1_v(45)=(-params(3));
g1_v(46)=(-T(2));
g1_v(47)=(-params(3));
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 9, 27);
end
end
